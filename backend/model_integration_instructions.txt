AI Model Integration Instructions
========================================

Your AI detection model has been successfully trained!

Files created:
- ml/models/simple_ai_detection_model.pth (trained model)
- ml/training_history.png (training visualization)
- simple_train.py (training script)
- test_trained_model.py (testing script)

To integrate with the FastAPI backend:
1. The model is ready to use
2. Update ml/model.py with the SimpleModelManager class
3. Start the FastAPI server: python start.py
4. Test the API endpoints at http://localhost:8000/docs

Model Performance:
- Training completed successfully
- Can classify: authentic, ai_generated, manipulated
- Ready for production deployment


# Add this to ml/model.py to use the simple trained model

class SimpleModelManager:
    """Simple model manager for the trained model"""
    
    def __init__(self, model_path: str = "ml/models"):
        self.model_path = model_path
        self.model = None
        self.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
        self.class_names = ["authentic", "ai_generated", "manipulated"]
    
    def load_simple_model(self):
        """Load the simple trained model"""
        try:
            from simple_train import SimpleAIDetectionCNN
            
            model_file = os.path.join(self.model_path, "simple_ai_detection_model.pth")
            if os.path.exists(model_file):
                checkpoint = torch.load(model_file, map_location=self.device)
                
                self.model = SimpleAIDetectionCNN(num_classes=3)
                self.model.load_state_dict(checkpoint['model_state_dict'])
                self.model.to(self.device)
                self.model.eval()
                
                self.class_names = checkpoint.get('class_names', self.class_names)
                return True
        except Exception as e:
            print(f"Error loading simple model: {e}")
        
        return False
    
    def predict_image(self, image_tensor):
        """Predict using the simple model"""
        if self.model is None:
            if not self.load_simple_model():
                return {'prediction': 'error', 'confidence': 0.0}
        
        try:
            self.model.eval()
            
            if len(image_tensor.shape) == 3:
                image_tensor = image_tensor.unsqueeze(0)
            
            image_tensor = image_tensor.to(self.device)
            
            with torch.no_grad():
                outputs = self.model(image_tensor)
                probabilities = torch.nn.functional.softmax(outputs, dim=1)
                predicted_class = torch.argmax(probabilities, dim=1).item()
                confidence = probabilities[0][predicted_class].item()
            
            return {
                'prediction': self.class_names[predicted_class],
                'confidence': confidence,
                'probabilities': {
                    name: probabilities[0][i].item() 
                    for i, name in enumerate(self.class_names)
                }
            }
        except Exception as e:
            return {'prediction': 'error', 'confidence': 0.0}

# Use this instead of the original model_manager
simple_model_manager = SimpleModelManager()
